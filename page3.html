<!DOCTYPE html>
<html>
 <head>
  <meta charset="UTF-8">
  <title>Kendell Crocker - About You</title>
  <link rel="stylesheet" href="style3.css" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
 </head>

<!--Header, this is mostly the same for each page-->
<section class="header">
    <!--Basic Information goes on the Left-->
    <div class="personal">
        <h3>Kendell Crocker</h3>
        <div>OSU Computer Science</div>
    </div>
    
    <!--And Page Title Goes In The Center-->
        <div class="title">
            <h1>About You</h1>
        </div>
    
    <!--Contact Info Goes On The Right-->
        <div class="contact">
            <a href="mailto:crockerk@oregonstate.edu"> <i class="fa fa-envelope"></i> Email</a><br>
            <a href="https://github.com/kcskier"> <i class="fa fa-github"></i> Github</a><br>
            <a href="https://www.linkedin.com/in/kendell-crocker-b2144519b"> <i class="fa fa-linkedin"></i> Linkedin</a><br>
        </div>
    
    </section>
    
    <!--Navigation around the website-->
    <section class="navigation">
        <a class="nav_elem_out" href="index.html">Home</a>
        <a class="nav_elem" href="page2.html">About Me</a>
        <a class="nav_elem" href="page3.html">About You</a>
        <a class="nav_elem_out" href="page4.html">Visitors</a>
    </section>

    <!--This page has a form, the form will be submitted, and stored to a file.
    Then this file will be called up by page 4, and it will have a list of
    every entry that was submitted.-->
<section class="submittable">
    <form class="input_form">
        <h2 style="text-align: center;">About You</h2>
        <label for="forf">Friend or Foe?</label><br>
        <input type="radio" id="forf_friend" name="forf" value="Friend"> Friend
        <input type="radio" id="forf" name="forf" value="Foe"> Foe<br> 
        <label for="name">Name: </label><input type="text" id="name"><br>
        <label for="food">Favorite Food: </label><input type="text" id="food"><br>
        <label for="age">Age: </label><select id="age"></select><br>
        <label for="submit"></label><button id="submit" type="button" onclick="submit_form()">Submit</button>
    </form>
    <div class="explain">
        So this form is a bunch of simple questions about you. After you fill them out and on submit, they
        are sent to httpbin via POST request. You will see the field values from the response appear below.
    </div>
</section>

<script>
    var age_select = document.getElementById("age");

    //populates the ages selector with numbers to choose from
    function pop_ages(selector) {
        var default_val = document.createElement("option");
        default_val.text = "";
        selector.add(default_val);
        for (i = 12; i < 86; i++) {
            var opt = document.createElement("option");
            opt.text = i;
            selector.add(opt);
        };
    };

    pop_ages(age_select);

    //For submitting the form
    function submit_form() {
        var url = "http://web.engr.oregonstate.edu/~zhangluy/tools/class-content/form_tests/check_request.php";
        var http = new XMLHttpRequest();

        var friend = document.getElementById("forf_friend").value;
        var name = document.getElementById("name").value;
        var food = document.getElementById("food").value;
        var age = document.getElementById("age").value;
        if (document.getElementById("forf_friend").checked) {
            friend = "Friend";
        }
        else {
            friend = "Foe";
        }

        var data = JSON.parse("{\"Friend\" : \"" + friend + "\", \"Name\" : \"" + name + "\", \"Food\" : \"" + food + "\", \"Age\" : \"" + age + "\"}");
        console.log(data);
        http.open("POST", "https://httpbin.org/post", false);
	    http.setRequestHeader('Content-Type', 'application/json');
	    http.send(JSON.stringify(data));
	    console.log(JSON.parse(http.responseText));

        //Write the values to the page
        var resp_forf = document.createElement("div");
        var resp_name = document.createElement("div");
        var resp_food = document.createElement("div");
        var resp_age = document.createElement("div");
        //Style the text
        resp_forf.style.fontFamily = "Calibri";
        resp_forf.style.fontSize = "16pt";
        resp_name.style.fontFamily = "Calibri";
        resp_name.style.fontSize = "16pt";
        resp_food.style.fontFamily = "Calibri";
        resp_food.style.fontSize = "16pt";
        resp_age.style.fontFamily = "Calibri";
        resp_age.style.fontSize = "16pt";
        //Add some text
        resp_name.textContent = "You are " + JSON.parse(http.response).json.Name;
        resp_forf.textContent = "You are a " + JSON.parse(http.response).json.Friend;
        resp_food.textContent = "Your favorite food is " + JSON.parse(http.response).json.Food;
        resp_age.textContent = "You are " + JSON.parse(http.response).json.Age + " years old.";
        //Add to the body
        document.body.appendChild(resp_name);
        document.body.appendChild(resp_forf);
        document.body.appendChild(resp_food);
        document.body.appendChild(resp_age);
    };
</script>

</html>